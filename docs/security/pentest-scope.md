# External Penetration Test Scope Document

**Document ID:** SEC-PENTEST-SCOPE-001
**Version:** 1.0
**Effective Date:** February 7, 2026
**Classification:** Internal - Confidential
**Related Documents:** SEC-PENTEST-001, SEC-PENTEST-ENV-001

---

## 1. Scope Overview

This document defines the comprehensive scope for external penetration testing of the Healthcare AI Assistant HIPAA-Aware RAG system. The scope encompasses all systems, components, and attack surfaces that must be assessed to validate the effectiveness of implemented security controls and identify potential vulnerabilities that could lead to PHI exposure, system compromise, or service disruption.

The penetration test scope has been carefully defined to ensure comprehensive coverage while respecting operational constraints, data protection requirements, and testing safety boundaries. The scope addresses all components that store, transmit, process, or are related to Protected Health Information (PHI) as required by HIPAA Security Rule evaluation procedures.

The testing scope reflects the system's architecture as a HIPAA-compliant healthcare AI assistant with RAG (Retrieval-Augmented Generation) capabilities, vector database storage, multi-tier web application architecture, and integration with cloud infrastructure services. Each component category includes specific testing objectives, techniques, and success criteria.

---

## 2. In-Scope Systems and Components

### 2.1 Web Application Components

The web application represents the primary user interface and attack surface for the Healthcare AI Assistant. All web application components are in scope for comprehensive security assessment.

**Frontend Application:**

The React-based frontend application, built with Next.js framework, is in scope for testing. This includes all user interface components, page routing, state management, and client-side security controls. Testing should address cross-site scripting vulnerabilities, client-side validation bypass, and client-side storage security for session data and sensitive information.

The frontend testing should evaluate the effectiveness of content security policy implementation, cookie security attributes, and protection against clickjacking and other client-side attack vectors. All user input paths through the frontend must be assessed for injection vulnerabilities and business logic weaknesses.

**API Layer:**

The Next.js API routes and backend endpoints are in scope for comprehensive testing. This includes all REST API endpoints handling authentication, authorization, document operations, chat interactions, user management, and administrative functions. Testing must address authentication mechanism security, authorization enforcement, input validation, and business logic vulnerabilities.

API testing should include comprehensive assessment of authentication and session management, role-based access control enforcement, rate limiting and abuse prevention, input validation for all parameters, and business logic flaw identification. The testing must validate that all security controls function correctly under attack conditions.

**Authentication System:**

The NextAuth.js authentication integration is in scope for testing. This includes credential handling, session token generation and management, multi-factor authentication implementation, OAuth provider integration security, and session fixation and hijacking protection. Testing must validate that authentication bypass is not possible and that session security meets HIPAA requirements.

### 2.2 Database and Storage Components

All data storage components that contain or are related to PHI are in scope for security assessment.

**Primary Database (Supabase/PostgreSQL):**

The Supabase PostgreSQL database with pgvector extension is in scope for testing. Testing includes database configuration security, row-level security policy enforcement, SQL injection vulnerability assessment, and access control verification. Testing must validate that RLS policies correctly enforce multi-tenant isolation and that database configuration meets HIPAA technical safeguard requirements.

Database testing should assess the effectiveness of encryption at rest, connection security, and audit logging integration. Any vulnerabilities that could lead to unauthorized data access must be identified and validated within safe testing boundaries.

**Vector Database (pgvector):**

The pgvector vector storage for document embeddings is in scope for testing. Testing should assess vector database-specific security concerns including embedding data protection, similarity search security, and potential for embedding-based attacks. The vector database stores derived representations of clinical documents, requiring protection commensurate with original document sensitivity.

**Document Storage:**

Document storage systems, whether object storage or database blob storage, are in scope for testing. Testing must assess upload vulnerability security, document access control enforcement, and document processing pipeline security. Document deprecation and deletion procedures must be validated for proper PHI disposition.

### 2.3 AI and Machine Learning Components

AI and ML components present unique security considerations requiring specialized testing approaches.

**Large Language Model Integration:**

The OpenAI LLM integration is in scope for security assessment. This represents a critical attack surface given the AI-assisted clinical decision support functionality. Testing must address prompt injection vulnerabilities, jailbreak attack resilience, prompt leakage, and LLM-specific attack vectors including adversarial prompts and model manipulation.

Specific LLM security testing includes direct prompt injection attempts through user input, jailbreak attacks attempting to override system instructions, context manipulation attacks attempting to poison retrieved context, instruction hierarchy attacks attempting to elevate privilege, and output manipulation attempts to generate malicious content.

**RAG Pipeline Security:**

The Retrieval-Augmented Generation pipeline is in scope for testing. This includes document chunking security, embedding generation security, context retrieval security, and prompt construction security. Testing must assess whether malicious documents could poison the knowledge base or whether retrieval could be manipulated to expose unintended information.

RAG pipeline testing should evaluate document ingestion security, chunking isolation between documents, embedding search security preventing cross-document information leakage, and context window manipulation attacks.

**Embedding Security:**

The text embedding generation process is in scope for testing. This includes embedding model security, embedding storage security, and embedding-based attack vectors such as embedding inversion attacks attempting to reconstruct original text from embeddings.

### 2.4 Infrastructure Components

Cloud infrastructure supporting the application is in scope for security assessment within defined constraints.

**Deployment Platform (Vercel):**

The Vercel deployment environment is in scope for configuration security assessment. This includes environment variable security, deployment pipeline security, edge function security, and Vercel-specific security configurations. Testing should identify any misconfigurations that could impact application security.

**Compute Security:**

Secure Compute capabilities if enabled are in scope for assessment. Testing should verify that compute isolation meets HIPAA requirements and that PHI processing occurs within appropriate security boundaries.

**Network Security:**

Network-level security controls are in scope for assessment. This includes TLS configuration, DNS security, and any network segmentation implementing security boundaries. Network testing should be conducted without causing service disruption.

### 2.5 Security Controls

All implemented security controls are in scope for validation testing.

**Rate Limiting System:**

The multi-tier rate limiting implementation (organization, user, session levels) is in scope for security assessment. Testing must validate that rate limits cannot be bypassed and that abuse detection functions correctly under attack conditions.

**PHI Detection System:**

The PHI detection and blocking system is in scope for security assessment. Testing must validate detection accuracy, assess false positive and false negative rates, and identify potential bypass techniques. Testing should attempt to craft inputs that evade PHI detection while containing actual PHI patterns.

**Injection Prevention System:**

The injection detection and blocking system is in scope for security assessment. This includes SQL injection prevention, prompt injection prevention, XSS prevention, and other injection attack vectors. Testing must validate that all injection categories are correctly detected and blocked.

**Audit Logging System:**

The audit logging system is in scope for security assessment. Testing must validate audit log completeness, integrity protection, and tamper detection capabilities. Testing should assess whether audit logging could be bypassed or manipulated.

---

## 3. Specific Testing Areas

### 3.1 Application Security Testing

Comprehensive application security testing validates the security of all application components and attack surfaces.

**Authentication Testing:**

Authentication security testing includes credential strength assessment, multi-factor authentication bypass attempts, session token security evaluation, authentication flow vulnerability identification, and OAuth/OpenID Connect security assessment. Testing must validate that authentication meets HIPAA requirements for unique identification and MFA enforcement.

**Authorization Testing:**

Authorization testing includes vertical privilege escalation attempts, horizontal privilege escalation attempts, insecure direct object reference identification, role-based access control bypass attempts, and business logic authorization vulnerability identification. Testing must validate that all access controls function correctly across all user roles.

**Input Validation Testing:**

Input validation testing includes all injection vulnerability categories (SQL, XSS, command injection, LDAP injection, XML injection), input size and format validation bypass attempts, file upload vulnerability assessment, and deserialization vulnerability identification. All user input paths must be assessed for injection vulnerabilities.

**Session Management Testing:**

Session management testing includes session fixation vulnerability assessment, session hijacking vulnerability identification, concurrent session control validation, session timeout enforcement verification, and session token randomness assessment.

### 3.2 API Security Testing

API security testing validates the security of all application programming interfaces.

**Authentication API Security:**

Testing of authentication endpoints for authentication bypass, credential stuffing protection effectiveness, MFA implementation security, and token generation randomness.

**Business API Security:**

Testing of business logic endpoints for business rule enforcement, parameter manipulation vulnerabilities, API rate limiting bypass attempts, and insecure direct object references in API parameters.

**Data API Security:**

Testing of data retrieval and manipulation APIs for authorization enforcement, data filtering effectiveness, bulk data access protection, and sensitive data exposure through API responses.

### 3.3 AI/LLM Security Testing

AI/LLM security testing addresses unique vulnerabilities associated with large language model systems.

**Prompt Injection Testing:**

Prompt injection testing includes direct prompt injection attempts, indirect prompt injection through controlled documents, context manipulation attacks, instruction hierarchy attacks, and encoding-based injection evasion techniques. Testing must validate that system prompts cannot be overridden or leaked through user interactions.

**Jailbreak Attack Testing:**

Jailbreak attack testing includes role-play attacks, scenario-based attacks, authority escalation attempts, and multi-turn jailbreak sequences. Testing should use both known jailbreak techniques and novel attack development. The target is less than 5% successful jailbreak rate under sophisticated attack conditions.

**Output Security Testing:**

Output security testing validates that AI outputs do not contain malicious content, PHI leakage, or manipulated information. Testing must assess whether the system can be induced to output PHI, generate harmful content, or provide incorrect clinical information.

**Model Manipulation Testing:**

Model manipulation testing assesses whether the model can be manipulated through adversarial inputs, training data poisoning through document ingestion, or embedding-based attacks.

### 3.4 PHI Handling Security Testing

PHI-specific security testing validates the effectiveness of PHI protection controls.

**PHI Detection Bypass Testing:**

PHI detection bypass testing attempts to craft inputs containing PHI that evade detection mechanisms. Testing should include novel PHI pattern development, encoding-based evasion, fragmentation-based evasion, and context-based evasion techniques.

**PHI Access Control Testing:**

PHI access control testing validates that access controls correctly restrict PHI access to authorized users with legitimate purposes. Testing includes cross-tenant PHI access attempts, unauthorized PHI retrieval through API manipulation, and audit log manipulation attempts.

**PHI Encryption Testing:**

PHI encryption testing validates that PHI is appropriately encrypted at rest and in transit. Testing includes encryption configuration verification and key management security assessment.

### 3.5 Compliance Validation Testing

Compliance validation testing confirms that technical safeguards meet regulatory requirements.

**HIPAA Technical Safeguard Testing:**

Testing validates implementation of all HIPAA Security Rule technical safeguards including 164.312 access control, 164.312 audit controls, 164.312 integrity controls, 164.312 transmission security, and 164.312 authentication requirements.

**Audit Control Testing:**

Audit control testing validates that audit logging meets HIPAA requirements including logging completeness, audit log access controls, and audit log integrity protection.

**Access Control Testing:**

Access control testing validates unique user identification, emergency access procedures, automatic logoff, and encryption of PHI at rest requirements.

---

## 4. Testing Techniques and Methodologies

### 4.1 Manual Testing Techniques

Manual testing provides thorough assessment that automated tools cannot achieve, particularly for business logic and AI-specific vulnerabilities.

**Manual Vulnerability Assessment:**

Security consultants perform comprehensive manual vulnerability assessment including code review for identified areas, configuration assessment, and manual exploitation attempts within scope boundaries.

**Manual Business Logic Testing:**

Business logic vulnerabilities are identified through manual analysis of application workflows, transaction processing, and business rule enforcement. Manual testing is essential for identifying vulnerabilities that automated tools cannot detect.

**Manual AI Security Testing:**

AI-specific vulnerabilities require manual assessment by security consultants with AI security expertise. Manual testing develops novel attack techniques and evaluates system resilience against sophisticated AI attacks.

### 4.2 Automated Testing Techniques

Automated testing provides comprehensive coverage and efficient vulnerability identification.

**Dynamic Application Security Testing:**

Automated DAST tools scan the application from an external perspective, identifying common web application vulnerabilities. DAST scanning is conducted against staging environment with appropriate preparations.

**API Security Testing:**

Automated API security testing validates API endpoints for injection vulnerabilities, broken authentication, and improper asset management. API testing tools are configured with appropriate authentication for comprehensive coverage.

**Software Composition Analysis:**

SCA tools analyze application dependencies for known vulnerabilities. Testing includes identification of outdated or vulnerable components requiring updates.

### 4.3 Specialized Testing

Specialized testing addresses unique system components and requirements.

**Container and Infrastructure Scanning:**

Container and infrastructure scanning identifies misconfigurations and vulnerabilities in deployment configurations, container security settings, and infrastructure-as-code security.

**Cloud Security Assessment:**

Cloud security assessment validates cloud service configuration against security best practices and compliance requirements. Assessment covers identity and access management, storage security, and network security configurations.

---

## 5. Out-of-Scope Items

### 5.1 Explicitly Excluded Components

The following components are explicitly out of scope for this penetration test engagement.

**Physical Security:**

Physical security assessment including facility access controls, physical penetration attempts, hardware tampering, and physical social engineering is out of scope.

**Denial of Service Testing:**

Denial of service attacks that could impact availability for legitimate users are out of scope. Testing may verify rate limiting effectiveness without attempting service disruption.

**Third-Party Vendor Systems:**

Security assessment of third-party vendor systems not operated by the organization is out of scope. Testing may interact with vendor systems as part of application testing but must not target vendor infrastructure.

**Social Engineering:**

Social engineering attacks including phishing, vishing, and in-person social engineering are out of scope unless specifically authorized in writing before the engagement.

### 5.2 Testing Limitations

Certain limitations apply to all testing activities regardless of scope categorization.

**Data Exfiltration Prohibition:**

Actual data exfiltration, including PHI, is prohibited. Any testing that could potentially access sensitive data must be conducted through proof-of-concept techniques without actual data extraction.

**Production Stability:**

Testing must not intentionally cause production system crashes, data corruption, or sustained service disruption. Any testing technique with potential for significant impact requires advance approval.

**Legal and Regulatory Boundaries:**

Testing must comply with all applicable laws and regulations. Any testing technique that could violate laws or regulations is prohibited regardless of scope categorization.

---

## 6. Attack Surface Mapping

### 6.1 External Attack Surface

The external attack surface represents all attack vectors accessible from the public internet.

**Web Application Attack Surface:**

The primary web application interface accessible at the production URL is the main external attack surface. This includes all user-facing pages, authentication interfaces, and API endpoints accessible from the internet.

**Authentication Endpoints:**

All authentication-related endpoints including login, logout, registration, password reset, and MFA verification are part of the external attack surface.

**API Attack Surface:**

Public API endpoints accessible without authentication and authenticated API endpoints are part of the external attack surface. Testing includes both documented and undocumented API endpoints.

### 6.2 Internal Attack Surface

The internal attack surface represents attack vectors accessible only from authenticated sessions or internal networks.

**Authenticated User Attack Surface:**

All functionality accessible to authenticated users within their authorized scope is part of the internal attack surface. This includes user-specific features, document access, and chat functionality.

**Administrative Interface Attack Surface:**

Administrative interfaces and privileged functionality are part of the internal attack surface. Testing should validate that administrative access controls function correctly.

**Internal Service Attack Surface:**

Internal services and inter-service communication, where accessible, are part of the internal attack surface assessment.

---

## 7. Success Criteria

### 7.1 Testing Completion Criteria

The penetration test engagement is complete when all defined testing activities have been executed according to the approved methodology and scope.

**Coverage Criteria:**

Full coverage of all in-scope systems and components as documented in this scope document. All defined testing techniques have been applied to relevant targets. All critical and high-risk attack vectors have been thoroughly tested.

**Finding Criteria:**

All identified vulnerabilities are documented with complete technical details, severity assessment, and remediation recommendations. Evidence is collected for all findings to enable verification.

### 7.2 Security Posture Criteria

The testing assesses security posture against defined benchmarks.

**Critical Vulnerability Criteria:**

Zero critical severity vulnerabilities should be present in the tested environment. Any critical findings require immediate remediation and management notification.

**High Vulnerability Criteria:**

Limited high severity vulnerabilities should be present with documented remediation plans. High findings should be remediated within defined timelines.

**Overall Security Posture:**

The testing provides overall assessment of security posture including identification of security strengths and areas requiring improvement. The assessment informs security roadmap development and resource allocation.

---

## 8. Scope Change Management

### 8.1 Scope Modification Process

Scope modifications require formal approval through documented change management process.

**Change Request Process:**

Any request to modify the testing scope must be submitted in writing with justification and impact assessment. Changes must be approved by the designated security contact before implementation.

**Emergency Scope Changes:**

Emergency scope changes required due to operational constraints or security concerns may be approved verbally with written confirmation within 24 hours.

### 8.2 Scope Deviation Documentation

Any deviations from the approved scope during testing execution must be documented.

**Deviation Documentation:**

Deviations from the approved scope must be documented including reason for deviation, impact on testing completeness, and recommendation for addressing in future testing.

---

## 9. Compliance Mapping

### 9.1 HIPAA Requirements Mapping

This penetration test scope addresses the following HIPAA Security Rule requirements.

| HIPAA Requirement | Addressed By | Testing Activity |
|-------------------|--------------|------------------|
| 164.308(a)(8) Evaluation Procedures | External Penetration Test | Comprehensive security assessment |
| 164.312(a)(1) Access Control | Authentication and Authorization Testing | Bypass attempts and access control validation |
| 164.312(b) Audit Controls | Audit Logging Testing | Audit completeness and integrity verification |
| 164.312(c) Transmission Security | Encryption Testing | TLS and encryption configuration validation |
| 164.312(d) Authentication | Authentication Testing | MFA and authentication mechanism assessment |
| 164.312(e)(1) Transmission Security | API Security Testing | Encryption and secure communication validation |

### 9.2 Industry Standard Mapping

This penetration test scope aligns with industry standards and frameworks.

| Standard | Addressed By | Coverage |
|----------|--------------|----------|
| OWASP Testing Guide | Web Application Testing | Comprehensive coverage of OWASP testing methodology |
| NIST CSF | Security Control Assessment | Identify, Detect, Protect, Respond functions |
| PTES | Penetration Testing Methodology | Full PTES methodology compliance |
| CVSS v3.1 | Severity Assessment | Consistent severity scoring for all findings |

---

## 10. Document Control

### 10.1 Revision History

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | February 7, 2026 | Claude | Initial release |

### 10.2 Approvals

| Role | Name | Signature | Date |
|------|------|-----------|------|
| Chief Information Security Officer | | | |
| Penetration Testing Vendor | | | |
| Security Team Lead | | | |

---

**Classification:** Internal - Confidential
**Handling Instructions:** This document contains sensitive security information. Distribution is limited to authorized personnel involved in penetration test planning and execution.
